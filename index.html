<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤ - ISHANT Technology</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }

        body { background: #f0f4ff; color: #333; }

        .topbar {
            background: linear-gradient(90deg, #1565c0, #1e88e5);
            color: #fff;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-circle {
            width: 36px; height: 36px; border-radius: 50%;
            background: #fff; color: #1565c0;
            display: flex; align-items: center; justify-content: center;
            font-weight: bold;
        }

        .page { max-width: 960px; margin: 16px auto 40px; padding: 0 12px; }

        .card {
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 16px;
            margin-top: 8px;
        }

        .card h2 { font-size: 20px; margin-bottom: 8px; }

        .info-box {
            background: #fff8e1;
            border-left: 4px solid #ffb300;
            padding: 10px 12px;
            font-size: 13px;
            margin-bottom: 12px;
        }

        form label { display: block; margin: 8px 0 4px; font-size: 14px; }

        form input, form select, form textarea {
            width: 100%; padding: 8px;
            border-radius: 6px; border: 1px solid #c5cae9;
            font-size: 14px;
        }

        .form-row { display: flex; flex-wrap: wrap; gap: 10px; }

        .form-group { flex: 1; min-width: 180px; }

        .btn {
            background: #1976d2; color: #fff;
            border: none; padding: 10px 18px;
            border-radius: 20px; cursor: pointer; font-size: 14px;
            margin-top: 12px;
        }

        .btn-tab {
            border-radius: 20px;
            border: 1px solid #1565c0;
            background: #e3f2fd;
            color: #1565c0;
            padding: 8px 14px;
            font-size: 14px;
            cursor: pointer;
        }

        .btn-tab.active {
            background: #1565c0;
            color: #fff;
        }

        .wa-btn {
            display:block;
            margin-top:12px;
            background:#25D366;
            color:#fff;
            padding:10px 18px;
            text-align:center;
            border-radius:20px;
            text-decoration:none;
            font-size:14px;
            cursor:pointer;
        }

        .wa-btn.loading {
            opacity: 0.7;
            background:#128C7E;
        }

        .error-text {
            color: red;
            font-size: 12px;
            margin-top: 2px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 13px;
        }

        th, td {
            border: 1px solid #cfd8dc;
            padding: 6px 8px;
            text-align: left;
        }

        th {
            background: #e3f2fd;
            font-weight: bold;
        }

        tbody tr:nth-child(even) {
            background: #f5f5f5;
        }

        .small {
            font-size: 12px;
            color: #555;
        }

        .tabs-row {
            display:flex;
            gap:10px;
            margin-top:12px;
            margin-bottom:4px;
            flex-wrap:wrap;
        }
    </style>
</head>

<body>

    <div class="topbar">
        <div class="logo-circle">IT</div>
        <div>‡§Ø‡§π ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤ ‡§á‡§∂‡§æ‡§Ç‡§§ ‡§ü‡•á‡§ï‡•ç‡§®‡•ã‡§≤‡•â‡§ú‡•Ä ‡§ï‡•Ä ‡§§‡§∞‡§´ ‡§∏‡•á ‡§¶‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à‡•§</div>
    </div>

    <div class="page">

        <!-- Tabs -->
        <div class="tabs-row">
            <button id="tabForm" class="btn-tab active" onclick="showSection('formSection')">
                ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£
            </button>
            <button id="tabList" class="btn-tab" onclick="showSection('listSection')">
                ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä
            </button>
        </div>

        <!-- SECTION 1: ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ -->
        <div id="formSection" style="display:block;">
            <div class="card">
                <h2>‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§´‡§º‡•â‡§∞‡•ç‡§Æ</h2>

                <div class="info-box">
                    <b>‡§∏‡•Ç‡§ö‡§®‡§æ :</b> ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§ú‡§≤‡•ç‡§¶ ‡§π‡•Ä ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§
                </div>

                <form id="vyaktiForm">

                    <div class="form-row">
                        <div class="form-group">
                            <label>‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§ï‡§æ ‡§®‡§æ‡§Æ *</label>
                            <input type="text" id="workerName" required>
                        </div>

                        <div class="form-group">
                            <label>‡§ú‡§®‡•ç‡§Æ ‡§§‡§ø‡§•‡§ø *</label>
                            <input type="date" id="dob" required>
                        </div>

                        <div class="form-group">
                            <label>‡§Ü‡§ß‡§æ‡§∞ ‡§®‡§Ç‡§¨‡§∞ *</label>
                            <input type="text"
                                   id="aadhaar"
                                   maxlength="12"
                                   placeholder="‡§Ü‡§™‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§∏‡•á ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞‡•ç‡§° ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§™‡§∞ ‡§ú‡§≤‡•ç‡§¶ ‡§π‡•Ä ‡§ì‡§ü‡•Ä‡§™‡•Ä ‡§≠‡•á‡§ú‡•Ä ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§"
                                   oninput="this.value=this.value.replace(/[^0-9]/g,'').slice(0,12);"
                                   required>
                            <small id="aadhaarMsg" class="error-text"></small>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ *</label>
                            <input type="tel"
                                   id="mobile"
                                   maxlength="10"
                                   oninput="this.value=this.value.replace(/[^0-9]/g,'').slice(0,10);"
                                   required>
                            <small id="mobileMsg" class="error-text"></small>
                        </div>

                        <div class="form-group">
                            <label>‡§§‡§π‡§∏‡•Ä‡§≤ *</label>
                            <select id="tehsil" required>
                                <option value="">‡§§‡§π‡§∏‡•Ä‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                                <option>‡§®‡§µ‡§æ‡§¨‡§ó‡§Ç‡§ú</option>
                                <option>‡§´‡§§‡•á‡§π‡§™‡•Å‡§∞</option>
                                <option>‡§∞‡§æ‡§Æ‡§∏‡§®‡•á‡§π‡•Ä‡§ò‡§æ‡§ü</option>
                                <option>‡§π‡•à‡§¶‡§∞‡§ó‡§¢‡§º</option>
                                <option>‡§∞‡§æ‡§Æ‡§®‡§ó‡§∞</option>
                                <option>‡§∏‡§ø‡§∞‡•å‡§≤‡•Ä</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>‡§¨‡•ç‡§≤‡•â‡§ï *</label>
                            <select id="block" required>
                                <option value="">‡§¨‡•ç‡§≤‡•â‡§ï ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                                <option>‡§¨‡§Ç‡§ï‡•Ä</option>
                                <option>‡§Æ‡§∏‡•å‡§≤‡•Ä</option>
                                <option>‡§¶‡•á‡§µ‡§æ</option>
                                <option>‡§π‡§∞‡§ñ</option>
                                <option>‡§´‡§§‡•á‡§π‡§™‡•Å‡§∞</option>
                                <option>‡§π‡•à‡§¶‡§∞‡§ó‡§¢‡§º</option>
                                <option>‡§¶‡§∞‡§ø‡§Ø‡§æ‡§¨‡§æ‡§¶</option>
                                <option>‡§∏‡•Ç‡§∞‡§§‡§ó‡§Ç‡§ú</option>
                                <option>‡§∏‡§ø‡§¶‡•ç‡§ß‡•å‡§∞</option>
                                <option>‡§™‡•Ç‡§∞‡•á ‡§°‡§≤‡§à</option>
                                <option>‡§®‡§ø‡§®‡•ç‡§¶‡•Ç‡§∞‡§æ</option>
                                <option>‡§§‡•ç‡§∞‡§ø‡§µ‡•á‡§¶‡•Ä‡§ó‡§Ç‡§ú</option>
                                <option>‡§∞‡§æ‡§Æ‡§®‡§ó‡§∞</option>
                                <option>‡§∏‡§ø‡§∞‡•å‡§≤‡•Ä ‡§ó‡§º‡•å‡§∏‡§™‡•Å‡§∞</option>
                                <option>‡§¨‡§®‡•Ä‡§ï‡•ã‡§°‡§∞</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‡§™‡§ø‡§® ‡§ï‡•ã‡§° *</label>
                            <input type="text"
                                   id="pincode"
                                   required
                                   maxlength="6"
                                   oninput="this.value=this.value.replace(/[^0-9]/g,'').slice(0,6);">
                        </div>

                        <div class="form-group">
                            <label>‡§™‡•ã‡§∏‡•ç‡§ü *</label>
                            <input type="text" id="post" required>
                        </div>

                        <div class="form-group">
                            <label>‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ *</label>
                            <input type="text" id="panchayat" required>
                        </div>

                        <div class="form-group" style="flex:2;">
                            <label>‡§™‡•Ç‡§∞‡§æ ‡§™‡§§‡§æ *</label>
                            <textarea id="address" rows="3" required></textarea>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‡§Ü‡§µ‡•á‡§¶‡§ï ‡§ï‡§æ ‡§®‡§æ‡§Æ *</label>
                            <input type="text"
                                   id="applicantName"
                                   placeholder="ASHA / AWW / BC / PANCHAYAT SAHAYAK / OTHER"
                                   required>
                        </div>

                        <div class="form-group">
                            <label>‡§Ü‡§µ‡•á‡§¶‡§ï ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ *</label>
                            <input type="tel"
                                   id="applicantMobile"
                                   maxlength="10"
                                   oninput="this.value=this.value.replace(/[^0-9]/g,'').slice(0,10);"
                                   required>
                        </div>
                    </div>

                    <button class="btn" type="submit">‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç</button>

                    <a id="wa1" class="wa-btn">WhatsApp ‡§™‡§∞ ‡§≠‡•á‡§ú‡•á‡§Ç (9454238343)</a>
                    <a id="wa2" class="wa-btn">WhatsApp ‡§™‡§∞ ‡§≠‡•á‡§ú‡•á‡§Ç (9569615494)</a>

                </form>
            </div>
        </div>

        <!-- SECTION 2: ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä -->
        <div id="listSection" style="display:none;">
            <div class="card">
                <h2>‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä</h2>
                <div class="info-box small">
                    ‡§Ø‡§π ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§Ü‡§™‡§ï‡•á Google Sheet ‡§∏‡•á ‡§ë‡§ü‡•ã‡§Æ‡•à‡§ü‡§ø‡§ï ‡§Ü‡§è‡§ó‡•Ä‡•§
                </div>

                <button class="btn" type="button" onclick="loadListFromSheet()">‡§≤‡§ø‡§∏‡•ç‡§ü ‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</button>

                <div style="overflow-x:auto;">
                    <table id="listTable">
                        <thead>
                            <tr>
                                <th>‡§ï‡•ç‡§∞‡§Æ ‡§∏‡§Ç.</th>
                                <th>‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§ï‡§æ ‡§®‡§æ‡§Æ</th>
                                <th>DOB</th>
                                <th>‡§Ü‡§ß‡§æ‡§∞ ‡§®‡§Ç‡§¨‡§∞</th>
                                <th>‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞</th>
                                <th>‡§™‡§§‡§æ</th>
                                <th>‡§Ü‡§µ‡•á‡§¶‡§ï ‡§ï‡§æ ‡§®‡§æ‡§Æ</th>
                                <th>‡§Ü‡§µ‡•á‡§¶‡§ï ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- ‡§°‡•á‡§ü‡§æ JS ‡§∏‡•á ‡§Ü‡§è‡§ó‡§æ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div> <!-- .page -->

<script>
/*
   Sheet URL (‡§∏‡§ø‡§∞‡•ç‡§´ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è):
   https://docs.google.com/spreadsheets/d/1V3-C-JIb7kurPuQVZeNX67Hs09BQk5jS1ZLA6OhVLTE/edit
*/

/* --------- IMPORTANT URLs ---------- */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxAqUQ5lwlQ5SMFjbnEnkOOI4lbB6Df0_HPhZGaYAR0ks1FZKL1JsMBmOQC9z9xSpBl/exec";
/* Apps Script ‡§ï‡§æ doGet() CSV ‡§¶‡•á ‡§∞‡§π‡§æ ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è ‡§â‡§∏‡•Ä URL ‡§ï‡•ã ‡§π‡§Æ list ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≠‡•Ä ‡§Ø‡•Ç‡§ú‡§º ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç */
const SHEET_CSV_URL = SCRIPT_URL;

/* ------- TABS / SECTION SWITCH ------- */
function showSection(sectionId) {
    document.getElementById("formSection").style.display = "none";
    document.getElementById("listSection").style.display = "none";

    document.getElementById(sectionId).style.display = "block";

    document.getElementById("tabForm").classList.remove("active");
    document.getElementById("tabList").classList.remove("active");

    if (sectionId === "formSection") {
        document.getElementById("tabForm").classList.add("active");
    } else {
        document.getElementById("tabList").classList.add("active");
    }
}

/* ------- LOCAL STORAGE HELPER ------- */
function getSavedRecords() {
    return JSON.parse(localStorage.getItem("savedRecords") || "[]");
}

function saveRecord(aadhaar, mobile) {
    const records = getSavedRecords();
    records.push({ aadhaar: aadhaar, mobile: mobile });
    localStorage.setItem("savedRecords", JSON.stringify(records));
}

/* ------- DUPLICATE CHECK FUNCTIONS ------- */
function checkDuplicateAadhaar() {
    const aadhaar = document.getElementById("aadhaar").value;
    const msg = document.getElementById("aadhaarMsg");
    msg.textContent = "";

    if (aadhaar.length < 12) return false;

    const records = getSavedRecords();
    const exists = records.some(r => r.aadhaar === aadhaar);

    if (exists) {
        msg.textContent = "‚ùå ‡§Ø‡§π ‡§Ü‡§ß‡§æ‡§∞ ‡§®‡§Ç‡§¨‡§∞ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à!";
    }

    return exists;
}

function checkDuplicateMobile() {
    const mobile = document.getElementById("mobile").value;
    const msg = document.getElementById("mobileMsg");
    msg.textContent = "";

    if (mobile.length < 10) return false;

    const records = getSavedRecords();
    const exists = records.some(r => r.mobile === mobile);

    if (exists) {
        msg.textContent = "‚ùå ‡§Ø‡§π ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à!";
    }

    return exists;
}

document.getElementById("aadhaar").addEventListener("input", checkDuplicateAadhaar);
document.getElementById("mobile").addEventListener("input", checkDuplicateMobile);

/* ------- FORM SUBMIT -> Apps Script + Sheet ------- */
document.getElementById("vyaktiForm").addEventListener("submit", async function(e) {
    e.preventDefault();

    const aadhaar = document.getElementById("aadhaar").value;
    const mobile  = document.getElementById("mobile").value;

    const aadhaarExists = checkDuplicateAadhaar();
    const mobileExists  = checkDuplicateMobile();

    if (aadhaarExists || mobileExists) {
        alert("‚ùå ‡§Ø‡§π ‡§Ü‡§ß‡§æ‡§∞/‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à, ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ‡•§");
        return;
    }

    // Apps Script ‡§ï‡•ã ‡§≠‡•á‡§ú‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§°‡•á‡§ü‡§æ (Sheet ‡§µ‡§æ‡§≤‡•á ‡§ï‡•â‡§≤‡§Æ ‡§ï‡•á ‡§π‡§ø‡§∏‡§æ‡§¨ ‡§∏‡•á)
    const payload = {
        workerName: document.getElementById("workerName").value,
        dob:        document.getElementById("dob").value,
        aadhaar:    aadhaar,
        mobile:     mobile,
        tahsil:     document.getElementById("tehsil").value,
        block:      document.getElementById("block").value,
        pincode:    document.getElementById("pincode").value,
        post:       document.getElementById("post").value,
        panchayat:  document.getElementById("panchayat").value,
        address:    document.getElementById("address").value,
        applicantName:   document.getElementById("applicantName").value,
        applicantMobile: document.getElementById("applicantMobile").value
    };

    try {
        const res = await fetch(SCRIPT_URL, {
            method: "POST",
            body: JSON.stringify(payload),
            headers: { "Content-Type": "application/json" }
        });

        const data = await res.json();
        if (data.status === "success") {
            saveRecord(aadhaar, mobile);
            alert("‚úÖ ‡§Ü‡§™‡§ï‡§æ  ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§ï‡§∞ ‡§≤‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à  JALD HI APKE AADHAR PR OTP BHEJ KR AADHAR STYAPAN KIYA JAYEGA  THANKYOU");
        } else {
            alert("‚ùå Sheet ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ: " + (data.message || ""));
        }
    } catch (err) {
        console.error(err);
        alert("‚ùå ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§™‡§æ‡§Ø‡§æ‡•§ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§´‡§ø‡§∞ ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç‡•§");
    }
});

/* ------- WHATSAPP DATA ------- */
function getFormData() {
    return (
        "*‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§µ‡§ø‡§µ‡§∞‡§£*\n\n" +
        "üë§ ‡§®‡§æ‡§Æ: " + workerName.value + "\n" +
        "üìÖ ‡§ú‡§®‡•ç‡§Æ ‡§§‡§ø‡§•‡§ø: " + dob.value + "\n" +
        "ü™™ ‡§Ü‡§ß‡§æ‡§∞ ‡§®‡§Ç‡§¨‡§∞: " + aadhaar.value + "\n" +
        "üì± ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤: " + mobile.value + "\n" +
        "üè¢ ‡§§‡§π‡§∏‡•Ä‡§≤: " + tehsil.value + "\n" +
        "üèò ‡§¨‡•ç‡§≤‡•â‡§ï: " + block.value + "\n" +
        "üìÆ ‡§™‡§ø‡§®‡§ï‡•ã‡§°: " + pincode.value + "\n" +
        "üè§ ‡§™‡•ã‡§∏‡•ç‡§ü: " + post.value + "\n" +
        "üåê ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§: " + panchayat.value + "\n" +
        "üìç ‡§™‡§§‡§æ: " + address.value + "\n\n" +
        "üôã‚Äç‚ôÇÔ∏è ‡§Ü‡§µ‡•á‡§¶‡§ï: " + applicantName.value + "\n" +
        "üìû ‡§Ü‡§µ‡•á‡§¶‡§ï ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤: " + applicantMobile.value
    );
}

function sendWhatsApp(number, btn) {
    const aadhaarExists = checkDuplicateAadhaar();
    const mobileExists  = checkDuplicateMobile();
    if (aadhaarExists || mobileExists) {
        alert("‚ùå ‡§Ø‡§π ‡§Ü‡§ß‡§æ‡§∞/‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à, WhatsApp ‡§≠‡•á‡§ú‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§°‡•á‡§ü‡§æ ‡§ö‡•á‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§");
        return;
    }

    btn.classList.add("loading");
    btn.innerText = "Sending...";

    setTimeout(() => {
        const url = "https://wa.me/91" + number + "?text=" + encodeURIComponent(getFormData());
        window.open(url, "_blank");
        btn.classList.remove("loading");
        btn.innerText = "WhatsApp ‡§™‡§∞ ‡§≠‡•á‡§ú‡•á‡§Ç (" + number + ")";
    }, 800);
}

wa1.onclick = () => sendWhatsApp("9454238343", wa1);
wa2.onclick = () => sendWhatsApp("9569615494", wa2);

/* ------- ‡§Ü‡§µ‡•á‡§¶‡§® ‡§≤‡§ø‡§∏‡•ç‡§ü ‚Äì Apps Script (CSV) ‡§∏‡•á ------- */
function loadListFromSheet() {
    fetch(SHEET_CSV_URL)
        .then(res => res.text())
        .then(text => {
            const rows = text.trim().split("\n");
            const tbody = document.querySelector("#listTable tbody");
            tbody.innerHTML = "";

            // ‡§Ö‡§ó‡§∞ ‡§™‡§π‡§≤‡•Ä row header ‡§π‡•à ‡§î‡§∞ ‡§¶‡§ø‡§ñ‡§æ‡§®‡•Ä ‡§π‡•à ‡§§‡•ã i=0 ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç
            for (let i = 1; i < rows.length; i++) {
                const cols = rows[i].split(",");

                // ‡§π‡§Æ‡§æ‡§∞‡•á Sheet ‡§Æ‡•á‡§Ç 13 ‡§ï‡•â‡§≤‡§Æ ‡§π‡•à‡§Ç, ‡§≤‡•á‡§ï‡§ø‡§® HTML table ‡§Æ‡•á‡§Ç 8 ‡§π‡•Ä ‡§¶‡§ø‡§ñ‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç
                if (cols.length < 8) continue;

                const tr = document.createElement("tr");

                tr.innerHTML = `
                    <td>${i}</td>
                    <td>${cols[0]}</td>  <!-- workerName -->
                    <td>${cols[1]}</td>  <!-- dob -->
                    <td>${cols[2]}</td>  <!-- aadhaar -->
                    <td>${cols[3]}</td>  <!-- mobile -->
                    <td>${cols[9]}</td>  <!-- address (J column index 9) -->
                    <td>${cols[10]}</td> <!-- applicantName -->
                    <td>${cols[11]}</td> <!-- applicantMobile -->
                `;

                tbody.appendChild(tr);
            }

            if (rows.length <= 1) {
                alert("‡§∂‡•Ä‡§ü ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§");
            }
        })
        .catch(err => {
            console.error(err);
            alert("‡§≤‡§ø‡§∏‡•ç‡§ü ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§Ü ‡§∞‡§π‡•Ä ‡§π‡•à‡•§ Apps Script ‡§≤‡§ø‡§Ç‡§ï ‡§î‡§∞ ‡§™‡§¨‡•ç‡§≤‡§ø‡§∂ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó ‡§ö‡•á‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§");
        });
}
</script>

</body>
    </html>
